<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
  <title>Dashboard · Mobile</title>

  <!-- Favicon -->
  <link rel="icon" href="data:image/x-icon;base64," />
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='lightgreen' stroke='black' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'><circle cx='12' cy='12' r='10'/><path d='M16.5 20.93a5 5 0 1 1-.6-9 7 7 0 0 0-13.9.6'/></svg>">

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans:wght@400;500;700;900&family=Spline+Sans:wght@400;500;700&display=swap" rel="stylesheet" />

  <!-- Tailwind (ok to swap for your external CSS later) -->
  <script src="https://cdn.tailwindcss.com"></script>

<style>
  /* ---------- Theme & safe areas ---------- */
  :root {
    --safe-bottom: env(safe-area-inset-bottom);
    --safe-top: env(safe-area-inset-top);

    /* Fallbacks in case the page doesn't define these elsewhere */
    --background-color: #111714;
    --background-color-dark: #111714;
    --background-color-light: #29382f;
    --text-color: #e5e7eb;
    --original-color: #9ca3af;
    --highlight-color: #4ade80;
    --border-color: #2e3a33;
    --hover-color: #1f2923;

    --button-background: #29382f;
    --button-hover: #4ade80;
  }

  /* Motion accessibility */
  @media (prefers-reduced-motion: reduce) {
    * { animation: none !important; transition: none !important; }
  }

  /* ---------- Desktop guard (mobile-only page) ---------- */
  @media (min-width: 768px) {
    body > .desktop-warning { display: flex; }
    main, .mobile-header, .mobile-tabbar { display: none !important; }
  }

  .desktop-warning {
    display: none;
    align-items: center;
    justify-content: center;
    min-height: 100vh;
    padding: 2rem;
    text-align: center;
    background: #0b0f0d;
    color: #fff;
  }

  /* ---------- Layout helpers ---------- */
  main { padding-bottom: calc(84px + var(--safe-bottom)); padding-top: calc(56px + var(--safe-top)); }

  /* Sticky notice under header */
  .notice-banner {
    position: sticky;
    top: calc(56px + var(--safe-top));
    left: 0;
    width: 100%;
    z-index: 50;
    display: none;
    border-radius: 12px;
    background-color: rgb(134, 0, 0);
    color: #fff;
    padding: .6rem .9rem;
    font-size: .9rem;
    border-bottom: 1px solid #2a3a30;
    margin-bottom: .75rem;
  }

  /* Horizontal scroll tabs (page-level) */
  .htabs { overflow-x: auto; -webkit-overflow-scrolling: touch; white-space: nowrap; }
  .htabs::-webkit-scrollbar { display: none; }

  /* ---------- Table default (desktop/tablet) ---------- */
  .table-container {
    margin-top: 12px;
    border-radius: 12px;
    border: 1px solid var(--border-color);
    overflow: hidden;
    background: var(--background-color);
  }
  .loading { padding: 20px; text-align: center; color: #a1a1aa; }

  .sort-button {
    background: #1f2923;
    border: 1px solid #2e3a33;
    color: #fff;
    padding: .5rem .75rem;
    border-radius: .6rem;
    font-size: .9rem;
    transition: border-color .2s ease, background-color .2s ease;
  }
  .sort-button.active { border-color: var(--highlight-color); }
  .sort-button:focus-visible { outline: 2px solid var(--highlight-color); outline-offset: 2px; }

  .page-info { color: #a1a1aa; font-size: .85rem; text-align: center; padding: 10px 0; }

  /* ---------- Mobile card-style rows ---------- */
  @media (max-width: 768px) {
    .table-container {
      border: none;
      background: transparent;
      box-shadow: none;
    }
    .table-header { display: none !important; }

    .table-rows {
      display: block !important;
      background: var(--background-color-dark);
      border: 1px solid var(--border-color);
      border-radius: 12px;
      padding: 0.9rem 1rem;
      margin: 0 0 0.8rem 0;
    }

    .table-rows .table-cell {
      display: flex !important;
      align-items: center;
      justify-content: space-between;
      gap: 0.75rem;
      padding: 0.5rem 0;
      border-bottom: 1px solid var(--border-color);
      font-size: 0.92rem;
      white-space: normal;
      min-height: 34px;
    }
    .table-rows .table-cell:last-child { border-bottom: none; }

    /* Labels injected by column index; keep these synced with your header order */
    .table-rows .table-cell:nth-child(1)::before { content: "Track ID"; }
    .table-rows .table-cell:nth-child(2)::before { content: "Title"; }
    .table-rows .table-cell:nth-child(3)::before { content: "Artist"; }
    .table-rows .table-cell:nth-child(4)::before { content: "Album"; }
    .table-rows .table-cell:nth-child(5)::before { content: "Release Date"; }
    .table-rows .table-cell:nth-child(6)::before { content: "Track Type"; }
    .table-rows .table-cell:nth-child(7)::before { content: "Audio"; }
    .table-rows .table-cell:nth-child(8)::before { content: "Status"; }

    .table-rows .table-cell::before {
      color: var(--original-color);
      font-weight: 600;
      flex: 0 0 44%;
      text-align: left;
      line-height: 1.2;
    }
    .table-rows .table-cell > * {
      margin-left: auto;
      text-align: right;
      max-width: 56%;
      line-height: 1.2;
    }

    /* Track ID chip */
    .table-rows .table-cell:nth-child(1) .table-cell-highlight {
      display: inline-block;
      background: var(--background-color-light);
      color: var(--highlight-color);
      padding: 0.25rem 0.5rem;
      border-radius: 6px;
      font-weight: 700;
    }

    /* Play button spacing */
    .table-rows .table-cell .play-button { white-space: nowrap; }

    /* Smaller phones */
    @media (max-width: 420px) {
      .table-rows { padding: 0.75rem 0.85rem; }
      .table-rows .table-cell { font-size: 0.85rem; gap: 0.5rem; }
      .table-rows .table-cell::before { flex-basis: 48%; }
      .table-rows .table-cell > * { max-width: 52%; }
    }
  }

  /* ---------- Pagination ---------- */
  .paginationContainer {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    margin-top: 1rem;
    justify-content: center;
  }
  .pagination-button {
    background: var(--button-background);
    color: var(--text-color);
    border: 1px solid var(--border-color);
    padding: 0.5rem 0.9rem;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.2s ease;
    font-weight: 500;
    font-size: 0.875rem;
    min-width: 40px;
    text-align: center;
  }
  .pagination-button:hover:not(:disabled) {
    background: var(--button-hover);
    color: #111714;
    border-color: var(--button-hover);
  }
  .pagination-button:focus-visible { outline: 2px solid var(--highlight-color); outline-offset: 2px; }
  .pagination-button:disabled { opacity: 0.5; cursor: not-allowed; }

  /* Make JS-injected active page consistent with theme */
  .pagination-button[disabled][style*="background: #4ade80"] {
    background: var(--highlight-color) !important;
    color: #111714 !important;
    border-color: var(--highlight-color) !important;
    font-weight: 700;
  }

  /* ---------- Chart bits (unchanged, but theme-aligned) ---------- */
  .circular-chart { display: block; margin: 10px auto; max-width: 80%; max-height: 220px; }
  .circle-bg { fill: none; stroke: var(--background-color-light); stroke-width: 3.8; }
  .circle { fill: none; stroke-width: 2.8; stroke-linecap: round; animation: progress 1s ease-out forwards; }
  @keyframes progress { 0% { stroke-dasharray: 0 100; } }
  .percentage { fill: var(--highlight-color); font-family: 'Spline Sans', sans-serif; font-size: .5em; text-anchor: middle; font-weight: 600; }
  .stats-card { background: linear-gradient(135deg, #1a211c 0%, #29382f 100%); border: 1px solid #2a3a30; }

  /* ---------- Bottom tabbar ---------- */
  .mobile-tabbar {
    position: fixed;
    bottom: 0; left: 0; right: 0;
    padding-bottom: calc(10px + var(--safe-bottom));
    background: rgba(23,31,27,.9);
    backdrop-filter: saturate(180%) blur(10px);
    border-top: 1px solid #243228;
    z-index: 50;
  }
  .tab-btn { font-size: 11px; line-height: 1; }
  .tab-icon { width: 22px; height: 22px; }
</style>

</head>

<body class="bg-[#111714] text-white min-h-screen font-[Spline Sans]">

  <!-- Shown on desktop/tablet to prevent using this page -->
  <div class="desktop-warning">
    <div>
      <div class="mx-auto mb-4 w-12 h-12 rounded-full flex items-center justify-center bg-[#1b241f] border border-[#243228]">
        <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6" fill="lightgreen" viewBox="0 0 24 24" stroke="black" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M16.5 20.93a5 5 0 1 1-.6-9 7 7 0 0 0-13.9.6"/></svg>
      </div>
      <h1 class="text-xl font-extrabold">Mobile Dashboard Only</h1>
      <p class="mt-2 text-[#a1a1aa]">Open this on your phone, or use the desktop version of the dashboard.</p>
    </div>
  </div>

  <!-- Sticky Mobile Header -->
  <header class="mobile-header fixed top-0 left-0 right-0 z-50 bg-[#111714] border-b border-[#243228] pt-[env(safe-area-inset-top)]">
    <div class="h-14 flex items-center justify-between px-4">
      <div class="flex items-center gap-2">
        <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="lightgreen" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="M16.5 20.93a5 5 0 1 1-.6-9 7 7 0 0 0-13.9.6"/></svg>
        <span class="text-sm font-bold bg-gradient-to-r from-green-400 to-green-200 bg-clip-text text-transparent">Trend My Song</span>
      </div>
      <button onclick="logout()" class="text-red-300 text-xs flex items-center gap-1 px-2 py-1 rounded-lg bg-[#1f2923] border border-[#2e3a33]">
        Log Out
      </button>
    </div>
  </header>
  <main class="px-4">
      <h3 class="text-m text-gray-400 mt-3 mb-5">The dashboard isn’t fully available on mobile. Please log in from a desktop, laptop, or wide screen device</h3>
    <h2 class="text-xl font-bold mb-3">Dashboard</h2>

    <!-- Inline page tabs (Overview / Current Plan / Claim Management / Support Team) -->
    <div class="mb-4 border-b border-[#29382f] htabs">
      <div class="flex gap-5">
        <button class="tab-button pb-2 border-b-2 border-white font-semibold text-sm"
                data-tab="overview" aria-selected="true" role="tab" id="tab-overview"
                aria-controls="panel-overview" tabindex="0">Overview</button>

        <button class="tab-button pb-2 border-b-2 border-transparent hover:border-[#4ade80] font-semibold text-sm"
                data-tab="control-panel" aria-selected="false" role="tab" id="tab-control-panel"
                aria-controls="panel-control-panel" tabindex="-1">Current Plan</button>

        <button class="tab-button pb-2 border-b-2 border-transparent hover:border-[#4ade80] font-semibold text-sm"
                data-tab="claim-management" aria-selected="false" role="tab" id="tab-claim-management"
                aria-controls="panel-claim-management" tabindex="-1">Claim Management</button>

        <button class="tab-button pb-2 border-b-2 border-transparent hover:border-[#4ade80] font-semibold text-sm"
                data-tab="support-team" aria-selected="false" role="tab" id="tab-support-team"
                aria-controls="panel-support-team" tabindex="-1">Support Team</button>
      </div>
    </div>

    <!-- Rejections banner -->
    <div class="notice-banner">
      ⛔ There <span id="verb">are</span> <span id="rejected-count">0</span> rejected, suspended or removed <span id="noun">tracks</span>, please check the track list below.
    </div>

    <!-- ===== Overview ===== -->
    <section id="overview" class="tab-panel" role="tabpanel" aria-labelledby="tab-overview" tabindex="0">
      <!-- KPIs -->
      <div class="grid grid-cols-1 gap-3 mb-6">
        <div class="bg-[#29382f] rounded-xl p-4">
          <h3 class="text-base font-semibold mb-2">In Review</h3>
          <p class="text-3xl font-extrabold" id="review">—</p>
          <p class="mt-1 text-[#a1a1aa] text-sm">Tracks In Review</p>
        </div>
        <div class="bg-[#29382f] rounded-xl p-4">
          <h3 class="text-base font-semibold mb-2">In Progress</h3>
          <p class="text-3xl font-extrabold" id="progress">—</p>
          <p class="mt-1 text-[#a1a1aa] text-sm">Tracks In Progress</p>
        </div>
        <div class="bg-[#29382f] rounded-xl p-4">
          <h3 class="text-base font-semibold mb-2">Approved</h3>
          <p class="text-3xl font-extrabold" id="copyrighted">—</p>
          <p class="mt-1 text-[#a1a1aa] text-sm">Tracks Delivered</p>
        </div>
      </div>

      <!-- Track List -->
      <div class="mt-2">
        <h3 class="text-lg font-semibold mb-3">Track List</h3>

          <!-- Search (top) -->
        <div class="flex items-center gap-2">
          <input id="searchInput" type="text" placeholder="Search by title or artist..."
                class="bg-[#1f2923] text-white px-4 py-2.5 rounded-lg w-full border border-[#2e3a33] focus:border-[#4ade80] focus:outline-none transition-colors" />
        </div>

        <div class="table-container">
          <div id="dataContainer">
            <div class="loading">Loading tracks...</div>
          </div>
        </div>
        <div class="page-info" id="pageInfo"></div>
      </div>
    </section>

    <!-- ===== Current Plan / Control Panel ===== -->
    <section id="control-panel" class="tab-panel" role="tabpanel" aria-labelledby="tab-control-panel" tabindex="0" style="display:none;">
      <div class="grid grid-cols-1 gap-4 mb-4">
        <!-- Tracks Usage -->
        <div class="bg-[#1a211c] rounded-xl p-4 border border-[#2a3a30] shadow-lg">
          <h3 class="text-base font-semibold mb-3 text-white flex items-center gap-2">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 18V5l12-2v13"/><path d="m9 9 12-2"/><circle cx="6" cy="18" r="3"/><circle cx="18" cy="16" r="3"/></svg>
            Tracks Usage
          </h3>

          <div class="flex items-center justify-between gap-3">
            <div class="flex-1">
              <svg viewBox="0 0 36 36" class="circular-chart">
                <path class="circle-bg" d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"/>
                <path id="circularProgress" class="circle" stroke="url(#gradient)" stroke-dasharray="0, 100" d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"/>
                <defs>
                  <linearGradient id="gradient" x1="0%" y1="0%" x2="100%" y2="0%">
                    <stop offset="0%" style="stop-color:#4ade80;stop-opacity:1" />
                    <stop offset="100%" style="stop-color:#22c55e;stop-opacity:1" />
                  </linearGradient>
                </defs>
                <text x="18" y="20.35" class="percentage" id="percentageText">0%</text>
              </svg>
            </div>

            <div class="flex-1 space-y-3">
              <div class="stats-card rounded-lg p-3">
                <span class="block text-gray-400 text-xs mb-1">Uploaded</span>
                <span id="tracksUploaded" class="text-xl font-bold text-green-300">-</span>
              </div>
              <div class="stats-card rounded-lg p-3">
                <span class="block text-gray-400 text-xs mb-1">Remaining</span>
                <span id="tracksLeft" class="text-xl font-bold text-blue-300">-</span>
              </div>
              <div class="stats-card rounded-lg p-3">
                <span class="block text-gray-400 text-xs mb-1">Total Limit</span>
                <span id="trackLimit" class="text-xl font-bold text-purple-300">-</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Services -->
        <div class="bg-[#1a211c] rounded-xl p-4 border border-[#2a3a30] shadow-lg">
          <h3 class="text-base font-semibold mb-3 text-white flex items-center gap-2">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="7" height="9" x="3" y="3" rx="1"/><rect width="7" height="5" x="14" y="3" rx="1"/><rect width="7" height="9" x="14" y="12" rx="1"/><rect width="7" height="5" x="3" y="16" rx="1"/></svg>
            Active Services
          </h3>

          <div class="space-y-2">
            <div class="flex items-center justify-between p-3 bg-[#29382f] rounded-lg border border-[#354a3d]">
              <div class="flex items-center gap-2">
                <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="none" stroke="lightgreen" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="M14.83 14.83a4 4 0 1 1 0-5.66"/></svg>
                <span class="text-white text-sm">YouTube Content-ID</span>
              </div>
              <span id="YT" class="px-3 py-1 text-xs rounded-full font-medium">-</span>
            </div>

            <div class="flex items-center justify-between p-3 bg-[#29382f] rounded-lg border border-[#354a3d]">
              <div class="flex items-center gap-2">
                <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="none" stroke="lightgreen" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="20" height="20" x="2" y="2" rx="5" ry="5"/><path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"/><line x1="17.5" x2="17.51" y1="6.5" y2="6.5"/></svg>
                <span class="text-white text-sm">Social Media</span>
              </div>
              <span id="SM" class="px-3 py-1 text-xs rounded-full font-medium">-</span>
            </div>

            <div class="flex items-center justify-between p-3 bg-[#29382f] rounded-lg border border-[#354a3d]">
              <div class="flex items-center gap-2">
                <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="none" stroke="lightgreen" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m11 7.601-5.994 8.19a1 1 0 0 0 .1 1.298l.817.818a1 1 0 0 0 1.314.087L15.09 12"/><path d="M16.5 21.174C15.5 20.5 14.372 20 13 20c-2.058 0-3.928 2.356-6 2-2.072-.356-2.775-3.369-1.5-4.5"/><circle cx="16" cy="7" r="5"/></svg>
                <span class="text-white text-sm">Streaming Platforms</span>
              </div>
              <span id="DSP" class="px-3 py-1 text-xs rounded-full font-medium">-</span>
            </div>

            <div class="flex items-center justify-between p-3 bg-[#29382f] rounded-lg border border-[#354a3d]">
              <div class="flex items-center gap-2">
                <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="none" stroke="lightgreen" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"/></svg>
                <span class="text-white text-sm">Promotion Campaigns</span>
              </div>
              <span id="PM" class="px-3 py-1 text-xs rounded-full font-medium">-</span>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- ===== Claim Management ===== -->
    <section id="claim-management" class="tab-panel" role="tabpanel" aria-labelledby="tab-claim-management" tabindex="0" style="display:none;">
      <div class="grid grid-cols-1 gap-4 mb-4">
        <!-- Whitelist -->
        <div class="bg-[#1a211c] rounded-xl p-4">
          <h3 class="text-base font-semibold mb-3">Whitelist YouTube Channel</h3>
          <form id="whitelistForm" class="space-y-3" onsubmit="handleWhitelistSubmit(event)">
            <div>
              <label for="channelUrl" class="block text-xs font-medium mb-2">YouTube Channel URL</label>
              <input type="text" id="channelUrl" name="channelUrl" placeholder="https://youtube.com/channel/..."
                     class="w-full bg-[#1f2923] text-white px-3 py-2 rounded-lg border border-[#2e3a33] focus:border-[#4ade80] focus:outline-none transition-colors" required />
            </div>

            <div>
              <label class="block text-xs font-medium mb-2 mt-2">Whitelist Option</label>
              <div class="grid grid-cols-1 gap-2">
                <label class="relative flex items-center p-3 bg-[#1f2923] rounded-lg border border-[#2e3a33] cursor-pointer hover:border-[#4ade80] transition-colors group">
                  <input type="radio" name="whitelistType" value="all" class="sr-only peer" checked />
                  <div class="w-4 h-4 border-2 border-[#4ade80] rounded-full mr-3 flex items-center justify-center peer-checked:bg-[#4ade80] transition-colors">
                    <div class="w-2 h-2 bg-white rounded-full opacity-0 peer-checked:opacity-100 transition-opacity"></div>
                  </div>
                  <div class="flex-1">
                    <span class="text-sm font-medium text-white">Whitelist from all tracks</span>
                    <p class="text-xs text-[#a1a1aa] mt-1">Apply whitelist to all your uploaded tracks</p>
                  </div>
                </label>

                <label class="relative flex items-center p-3 bg-[#1f2923] rounded-lg border border-[#2e3a33] cursor-pointer hover:border-[#4ade80] transition-colors group">
                  <input type="radio" name="whitelistType" value="specific" class="sr-only peer" />
                  <div class="w-4 h-4 border-2 border-[#4ade80] rounded-full mr-3 flex items-center justify-center peer-checked:bg-[#4ade80] transition-colors">
                    <div class="w-2 h-2 bg-white rounded-full opacity-0 peer-checked:opacity-100 transition-opacity"></div>
                  </div>
                  <div class="flex-1">
                    <span class="text-sm font-medium text-white">Whitelist from specific tracks</span>
                    <p class="text-xs text-[#a1a1aa] mt-1">Choose which tracks to apply whitelist to</p>
                  </div>
                </label>
              </div>
            </div>

            <button type="submit" class="w-full bg-[#4ade80] text-black font-medium py-2.5 px-4 rounded-lg hover:bg-[#22c55e] transition-colors">
              Submit Whitelist Request
            </button>
          </form>
        </div>

        <!-- Claim Removal -->
        <div class="bg-[#1a211c] rounded-xl p-4">
          <h3 class="text-base font-semibold mb-3">YouTube Video Claim Removal</h3>
          <form id="claimRemovalForm" class="space-y-3" onsubmit="handleClaimRemovalSubmit(event)">
            <div>
              <label for="MainvideoUrl" class="block text-xs font-medium mb-2">YouTube Video Link</label>
              <input type="text" id="MainvideoUrl" name="MainvideoUrl" placeholder="https://youtube.com/watch?v=..."
                     class="w-full bg-[#1f2923] text-white px-3 py-2 rounded-lg border border-[#2e3a33] focus:border-[#4ade80] focus:outline-none transition-colors" required />
            </div>

            <div>
              <label for="additionalVideos" class="block text-xs font-medium mt-2 mb-2">Additional Video Links (Optional)</label>
              <textarea id="additionalVideos" name="additionalVideos" rows="4" maxlength="250"
                        placeholder="Enter up to 5 additional YouTube video links, one per line"
                        class="w-full bg-[#1f2923] text-white px-3 py-2 rounded-lg border border-[#2e3a33] focus:border-[#4ade80] focus:outline-none transition-colors resize-none"></textarea>
            </div>

            <button type="submit" class="w-full bg-[#4ade80] text-black font-medium py-2.5 px-4 rounded-lg hover:bg-[#22c55e] transition-colors">
              Submit Claim Removal Request
            </button>
          </form>
        </div>
      </div>
    </section>

    <!-- ===== Support Team ===== -->
    <section id="support-team" class="tab-panel" role="tabpanel" aria-labelledby="tab-support-team" tabindex="0" style="display:none;">
      <div class="grid grid-cols-1 gap-4">
        <div class="bg-[#29382f] rounded-xl p-4">
          <h3 class="text-base font-semibold mb-3">Support Statistics</h3>
          <div class="space-y-3 text-sm">
            <div class="flex justify-between"><span>Live Chat Support</span><span class="font-bold">Available</span></div>
            <div class="flex justify-between"><span>Average Response Time</span><span class="font-bold">24 hours</span></div>
          </div>
        </div>

        <div class="bg-[#29382f] rounded-xl p-4">
          <h3 class="text-base font-semibold mb-3">Quick Actions</h3>
          <div class="space-y-2">
            <button onclick="window.open('https://t.me/trendmysong', '_blank')" class="w-full bg-[#4ade80] text-black font-medium py-3 rounded-lg hover:bg-[#22c55e] transition-colors">
              Live Chat Support
            </button>
            <button onclick="document.getElementById('ticketModal').style.display='flex'" class="w-full bg-[#1f2923] text-white font-medium py-3 rounded-lg border border-[#2e3a33] hover:border-[#4ade80] transition-colors">
              Write a Ticket
            </button>

            <!-- Ticket Modal -->
            <div id="ticketModal" style="display:none;" class="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 p-4">
              <div class="bg-[#1a211c] rounded-xl p-5 border border-[#2a3a30] shadow-lg w-full max-w-md relative" onclick="event.stopPropagation()">
                <button onclick="document.getElementById('ticketModal').style.display='none'" class="absolute top-3 right-3 text-gray-400 hover:text-white transition-colors">
                  <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg>
                </button>

                <h3 class="text-base font-semibold mb-3 text-white">Write a Support Ticket</h3>

                <form id="ticketForm" onsubmit="handleTicketSubmit(event)" class="space-y-3">
                  <div>
                    <label for="ticketSubject" class="block text-xs font-medium mb-2">Subject</label>
                    <input type="text" id="ticketSubject" name="ticketSubject" placeholder="e.g., Issue with track upload"
                           class="w-full bg-[#1f2923] text-white px-3 py-2 rounded-lg border border-[#2e3a33] focus:border-[#4ade80] focus:outline-none transition-colors" required />
                  </div>

                  <div>
                    <label for="ticketMessage" class="block text-xs font-medium mb-2">Message</label>
                    <textarea id="ticketMessage" name="ticketMessage" rows="5" placeholder="Please describe your issue in detail..."
                              class="w-full bg-[#1f2923] text-white px-3 py-2 rounded-lg border border-[#2e3a33] focus:border-[#4ade80] focus:outline-none transition-colors" required></textarea>
                  </div>

                  <button type="submit" class="w-full bg-[#4ade80] text-black font-bold py-3 rounded-lg hover:bg-[#22c55e] transition-colors">
                    Send via Telegram
                  </button>
                </form>
              </div>
            </div>

            <script>
              function handleTicketSubmit(event) {
                event.preventDefault();
                const key = localStorage.getItem('key');
                const subject = document.getElementById('ticketSubject').value;
                const messageBody = document.getElementById('ticketMessage').value;
                if (!key) { alert('Control Key not found. Please make sure you are logged in.'); return; }
                const message = `Control Key: ${key}\n\nSubject: ${subject}\n\nMessage:\n${messageBody}`;
                const telegramUrl = `https://t.me/trendmysong?text=${encodeURIComponent(message)}`;
                window.open(telegramUrl, '_blank');
                document.getElementById('ticketModal').style.display = 'none';
                document.getElementById('ticketForm').reset();
              }
              document.getElementById('ticketModal').addEventListener('click', function(event) {
                if (event.target === this) this.style.display = 'none';
              });
            </script>
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- Shared scripts you already use -->
  <script>
    function logout() {
      localStorage.removeItem("username");
      localStorage.removeItem("key");
      window.location.href = "/";
    }
  </script>

  <!-- Bring your existing JS files if needed -->
  <script src="table-manager.js"></script>
  <script src="demo-key.js"></script>

  <!-- Inline logic from your original page (trimmed to mobile context) -->
  <script>
    async function fetchSummary() {
      try {
        const key = localStorage.getItem('key');
        if (!key || key === 'null') { console.error('Key not found'); window.location.href = '/'; return; }

        const statusResponse = await fetch(`/get-sheet-summary?key=${encodeURIComponent(key)}&sheetName=portal`);
        const data = await statusResponse.json();
        if (!Array.isArray(data) || data.length === 0) { console.error('No data available'); alert('No data available for the specified key'); return; }

        const summary = data[0];
        document.getElementById('copyrighted').textContent = summary['Copyrighted'] || 'N/A';
        document.getElementById('review').textContent = summary['In Review'] || 'N/A';
        document.getElementById('progress').textContent = summary['In Progress'] || 'N/A';

        const rejectedCount = Number(summary['Rejected']) || 0;
        const banner = document.querySelector('.notice-banner');
        const rejectedSpan = document.getElementById('rejected-count');
        const verbSpan = document.getElementById('verb');
        const nounSpan = document.getElementById('noun');

        if (rejectedCount > 0) {
          rejectedSpan.textContent = rejectedCount;
          verbSpan.textContent = rejectedCount === 1 ? 'is' : 'are';
          nounSpan.textContent = rejectedCount === 1 ? 'track' : 'tracks';
          banner.style.display = 'block';
        } else {
          banner.style.display = 'none';
        }
      } catch (error) {
        console.error('Error fetching data:', error);
        alert('Error: Data Fetching (Contact the Support Team)');
      }
    }

    // Tabs (page-level)
    document.querySelectorAll('.tab-button').forEach(button => {
      button.addEventListener('click', () => {
        document.querySelectorAll('.tab-button').forEach(tab => {
          tab.classList.remove('border-white'); tab.classList.add('border-transparent');
        });
        document.querySelectorAll('.tab-panel').forEach(panel => panel.style.display = 'none');
        button.classList.remove('border-transparent'); button.classList.add('border-white');
        const tabId = button.getAttribute('data-tab');
        document.getElementById(tabId).style.display = 'block';
        // scroll to top of content on tab change (mobile QoL)
        window.scrollTo({ top: 0, behavior: 'smooth' });
      });
    });

    // Sort buttons
    document.getElementById('sortOldToNew').addEventListener('click', function() {
      document.querySelectorAll('.sort-button').forEach(btn => btn.classList.remove('active'));
      this.classList.add('active');
      console.log('Sort: Oldest First');
    });
    document.getElementById('sortNewToOld').addEventListener('click', function() {
      document.querySelectorAll('.sort-button').forEach(btn => btn.classList.remove('active'));
      this.classList.add('active');
      console.log('Sort: Newest First');
    });

    // Track usage circle
    async function updateTrackUsage() {
      const key = localStorage.getItem('key');
      if (!key) return console.error('Login key not found.');
      try {
        const response = await fetch(`/tracks-usage?key=${encodeURIComponent(key)}`);
        if (!response.ok) throw new Error('Failed to fetch track usage');
        const usageData = await response.json();
        if (!usageData || usageData.length === 0) return;

        const { limit, usage } = usageData[0];
        const uploaded = parseInt(usage, 10) || 0;
        const trackLimit = parseInt(limit, 10) || 0;
        const left = Math.max(trackLimit - uploaded, 0);
        const percentage = trackLimit > 0 ? Math.min((uploaded / trackLimit) * 100, 100) : 0;

        document.getElementById('tracksUploaded').textContent = uploaded;
        document.getElementById('tracksLeft').textContent = left;
        document.getElementById('trackLimit').textContent = trackLimit;
        document.getElementById('percentageText').textContent = Math.round(percentage) + '%';

        const circle = document.getElementById('circularProgress');
        circle.style.strokeDasharray = `${percentage}, 100`;
        if (percentage > 80) circle.style.stroke = '#ef4444';
        else if (percentage > 60) circle.style.stroke = '#f59e0b';
        else circle.style.stroke = 'url(#gradient)';
      } catch (e) { console.error('Error in updateTrackUsage:', e.message); }
    }

    async function fetchUsage() {
      const key = localStorage.getItem('key');
      if (!key) { console.error('No key found in localStorage.'); return; }
      try {
        const res = await fetch(`/tracks-usage?key=${encodeURIComponent(key)}`);
        if (!res.ok) throw new Error('Failed to fetch data');
        const data = await res.json();
        if (!Array.isArray(data) || data.length === 0) throw new Error('No data found for this key');

        const services = data[0].service;
        if (!services) { console.error('Missing service data'); return; }

        ['YT', 'SM', 'DSP', 'PM'].forEach(serviceKey => {
          const value = services[serviceKey];
          const el = document.getElementById(serviceKey);
          if (!el) return;
          if (value === 'Active') {
            el.textContent = 'Active';
            el.className = 'px-3 py-1 bg-[#4ade80] text-black text-xs rounded-full font-medium';
          } else {
            el.textContent = 'Inactive';
            el.className = 'px-3 py-1 bg-[#1f2923] text-red-300 text-xs rounded-full font-medium border border-[#ef4444]';
          }
        });
      } catch (err) {
        console.error('Error in fetchUsage:', err);
      }
    }

    // Forms (whitelist / claim removal)
    function handleWhitelistSubmit(event) {
      event.preventDefault();
      const key = localStorage.getItem('key');
      const channelUrl = document.getElementById('channelUrl').value;
      const whitelistType = document.querySelector('input[name="whitelistType"]:checked').value;
      const message = `Control Key: ${key}\nRequest Type: Whitelist YouTube Channel\nChannel URL: ${channelUrl}\nWhitelist Option: ${whitelistType}`;
      const telegramUrl = `https://t.me/trendmysong?text=${encodeURIComponent(message)}`;
      window.open(telegramUrl, '_blank');
    }
    function handleClaimRemovalSubmit(event) {
      event.preventDefault();
      const key = localStorage.getItem('key');
      const videoUrl = document.getElementById('MainvideoUrl').value;
      const additionalVideos = document.getElementById('additionalVideos').value;
      let message = `Control Key: ${key}\nRequest Type: YouTube Video Claim Removal\nMain Video URL: ${videoUrl}`;
      if (additionalVideos.trim()) message += `\n\nAdditional Video URLs:\n${additionalVideos}`;
      const telegramUrl = `https://t.me/trendmysong?text=${encodeURIComponent(message)}`;
      window.open(telegramUrl, '_blank');
    }

    // Init
    document.addEventListener('DOMContentLoaded', () => {
      fetchSummary();
      updateTrackUsage();
      fetchUsage();
    });
  </script>
</body>
</html>
